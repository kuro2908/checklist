<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - L·ªô tr√¨nh d·ª± √°n Web Truy·ªán</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Be Vietnam Pro', sans-serif;
            background-color: #f8fafc;
            /* slate-50 */
        }

        .progress-chart-container {
            position: relative;
            margin: auto;
            height: 150px;
            width: 100%;
            max-width: 150px;
        }

        .task-checkbox:checked+.task-text {
            text-decoration: line-through;
            color: #64748b;
            /* slate-500 */
        }

        .phase-header,
        .frontend-task-header {
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .phase-header:hover,
        .frontend-task-header:hover {
            background-color: #f1f5f9;
            /* slate-100 */
        }

        .rotate-180 {
            transform: rotate(180deg);
        }

        .status-badge,
        .status-select {
            font-size: 0.875rem;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-weight: 500;
            white-space: nowrap;
        }

        .status-select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-color: transparent;
            border: 1px solid #cbd5e1;
            padding-right: 1.75rem;
            background-repeat: no-repeat;
            background-position: right 0.4rem center;
            background-size: 1.2em;
            cursor: pointer;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%2364748b' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
        }

        .status-not-started {
            background-color: #f1f5f9;
            color: #475569;
        }

        .status-in-progress {
            background-color: #fef9c3;
            color: #a16207;
        }

        .status-completed {
            background-color: #dcfce7;
            color: #15803d;
        }

        .status-blocked {
            background-color: #fee2e2;
            color: #b91c1c;
        }

        .subtask-list {
            padding-left: 1.5rem;
            border-left: 2px solid #e2e8f0;
            margin-left: 0.5rem;
        }
    </style>
</head>

<body class="text-slate-800">

    <div class="container mx-auto p-4 md:p-8 max-w-3xl">

        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900">L·ªô tr√¨nh ph√°t tri·ªÉn d·ª± √°n Web Truy·ªán</h1>
            <p class="text-slate-600 mt-2">Dashboard theo d√µi ti·∫øn ƒë·ªô v√† c√°c giai ƒëo·∫°n ph√°t tri·ªÉn c·ªßa d·ª± √°n.</p>
        </header>

        <main class="space-y-8">

            <div class="bg-white p-6 rounded-xl shadow-md">
                <h2 class="text-xl font-bold text-center mb-4">Ti·∫øn ƒë·ªô Backend - Minh</h2>
                <div class="flex items-center gap-4">
                    <div class="progress-chart-container flex-shrink-0">
                        <canvas id="backendProgressChart"></canvas>
                    </div>
                    <div class="flex-grow text-center">
                        <p class="text-4xl font-bold text-sky-600" id="backend-percentage">0%</p>
                        <p class="text-slate-500" id="backend-tasks-summary">0/0 c√¥ng vi·ªác ho√†n th√†nh</p>
                    </div>
                </div>
                <details class="mt-4">
                    <summary class="cursor-pointer text-sm font-medium text-slate-600 hover:text-slate-900">Xem chi ti·∫øt
                        c√°c giai ƒëo·∫°n</summary>
                    <div class="mt-4 space-y-4" id="phases-container">
                    </div>
                </details>
            </div>

            <div id="frontend-progress-container" class="space-y-8">
                <!-- Frontend tasks will be rendered here by JS -->
            </div>

        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // =================================================================
            // DATA SOURCE
            // =================================================================
            const backendData = {
                phases: [
                    { id: 1, title: "Giai ƒëo·∫°n 1: N·ªÅn t·∫£ng & X√°c th·ª±c", goal: "X√¢y d·ª±ng c·∫•u tr√∫c, DB, API x√°c th·ª±c.", tasks: [{ text: "T·∫°o c·∫•u tr√∫c th∆∞ m·ª•c server v√† client.", done: true }, { text: "C√†i ƒë·∫∑t Express, Sequelize, mysql2, dotenv, cors.", done: true }, { text: "Thi·∫øt k·∫ø v√† t·∫°o Database MySQL ho√†n ch·ªânh.", done: true }, { text: "Ho√†n th√†nh file k·∫øt n·ªëi server/config/database.js.", done: true }, { text: "T·∫°o c√°c file model c·ªßa Sequelize.", done: true }, { text: "ƒê·ªãnh nghƒ©a c√°c m·ªëi quan h·ªá (associations).", done: true }, { text: "Backend: API ƒëƒÉng k√Ω & ƒëƒÉng nh·∫≠p (JWT).", done: true }, { text: "Backend: API ƒëƒÉng nh·∫≠p b·∫±ng Google.", done: true }, { text: "Frontend: C√†i ƒë·∫∑t v√† c·∫•u h√¨nh c∆° b·∫£n.", done: true }] },
                    { id: 2, title: "Giai ƒëo·∫°n 2: M·ªü r·ªông Database & X·ª≠ l√Ω l·ªói", goal: "Ho√†n thi·ªán c·∫•u tr√∫c d·ªØ li·ªáu v√† x·ª≠ l√Ω l·ªói.", tasks: [{ text: "DB: Th√™m c√°c c·ªôt/b·∫£ng c·∫ßn thi·∫øt (views, follows...).", done: true }, { text: "Model: C·∫≠p nh·∫≠t model v√† association t∆∞∆°ng ·ª©ng.", done: true }, { text: "Backend: X√¢y d·ª±ng middleware x·ª≠ l√Ω l·ªói t·∫≠p trung.", done: true }] },
                    { id: 3, title: "Giai ƒëo·∫°n 3: API Backend - Ch·ª©c nƒÉng c∆° b·∫£n", goal: "X√¢y d·ª±ng c√°c API CRUD ch√≠nh cho truy·ªán.", tasks: [{ text: "API l·∫•y danh s√°ch truy·ªán (ph√¢n trang, l·ªçc, s·∫Øp x·∫øp).", done: true }, { text: "API l·∫•y th√¥ng tin chi ti·∫øt m·ªôt truy·ªán.", done: true }, { text: "API l·∫•y danh s√°ch v√† n·ªôi dung ch∆∞∆°ng.", done: true }, { text: "API t√¨m ki·∫øm v√† tƒÉng l∆∞·ª£t xem truy·ªán.", done: true }, { text: "API cho B·∫£ng x·∫øp h·∫°ng.", done: true }] },
                    { id: 4, title: "Giai ƒëo·∫°n 4: API Backend - T∆∞∆°ng t√°c", goal: "X√¢y d·ª±ng c√°c API cho t√≠nh nƒÉng x√£ h·ªôi.", tasks: [{ text: "API Bookmark, L·ªãch s·ª≠ ƒë·ªçc.", done: true }, { text: "API ƒê√°nh gi√°/x·∫øp h·∫°ng truy·ªán.", done: true }, { text: "API B√¨nh lu·∫≠n (ch∆∞∆°ng & profile).", done: true }, { text: "API Theo d√µi ng∆∞·ªùi d√πng.", done: true }, { text: "API l·∫•y d·ªØ li·ªáu trang c√° nh√¢n.", done: true }] },
                    { id: 5, title: "Giai ƒëo·∫°n 5: API Backend - CMS", goal: "X√¢y d·ª±ng API cho t√°c gi·∫£ v√† qu·∫£n tr·ªã vi√™n.", tasks: [{ text: "API ƒëƒÉng/c·∫≠p nh·∫≠t ch∆∞∆°ng (t√≠ch h·ª£p Google Doc).", done: false }, { text: "API upload ·∫£nh b√¨a l√™n Cloudinary.", done: false }, { text: "API duy·ªát/t·ª´ ch·ªëi truy·ªán cho Admin.", done: false }, { text: "API B·∫£o m·∫≠t: Ho√†n thi·ªán middleware ki·ªÉm tra vai tr√≤.", done: false }] },
                    { id: 6, title: "Giai ƒëo·∫°n 6: Ho√†n thi·ªán & T∆∞∆°ng lai", goal: "C√°c t√≠nh nƒÉng cu·ªëi c√πng v√† n√¢ng cao.", tasks: [{ text: "Ch·ª©c nƒÉng Qu√™n m·∫≠t kh·∫©u.", done: false }, { text: "H·ªá th·ªëng th√¥ng b√°o ch∆∞∆°ng m·ªõi.", done: false }, { text: "Th·ª≠ nghi·ªám Three.js cho gi√° s√°ch 3D.", done: false }] }
                ]
            };

            const frontendData = {
                minh: {
                    name: "Minh", color: "sky", tasks: [
                        { title: "H·ªá th·ªëng Th√¥ng b√°o", subtasks: [{ text: "Component: Chu√¥ng th√¥ng b√°o tr√™n Header", status: 'not-started' }, { text: "Component: Trang xem danh s√°ch t·∫•t c·∫£ th√¥ng b√°o", status: 'not-started' }] },
                        { title: "Form ƒêƒÉng/S·ª≠a Truy·ªán", subtasks: [{ text: "Component: C√°c tr∆∞·ªùng nh·∫≠p li·ªáu (t√™n, m√¥ t·∫£...)", status: 'not-started' }, { text: "Component: L·ª±a ch·ªçn th·ªÉ lo·∫°i", status: 'not-started' }, { text: "Component: Upload ·∫£nh b√¨a (t√≠ch h·ª£p Cloudinary)", status: 'not-started' }] },
                        { title: "Trang Chi ti·∫øt truy·ªán", subtasks: [{ text: "Component: Hi·ªÉn th·ªã th√¥ng tin ch√≠nh (·∫£nh b√¨a, m√¥ t·∫£, t√°c gi·∫£...)", status: 'not-started' }, { text: "Component: Hi·ªÉn th·ªã ch·ªâ s·ªë (view, bookmark, rating)", status: 'not-started' }, { text: "Component: Danh s√°ch ch∆∞∆°ng", status: 'not-started' }] },
                        { title: "Qu·∫£n l√Ω Ch∆∞∆°ng", subtasks: [{ text: "Component: Danh s√°ch ch∆∞∆°ng c·ªßa m·ªôt truy·ªán", status: 'not-started' }, { text: "Component: Form ƒëƒÉng/s·ª≠a ch∆∞∆°ng", status: 'not-started' }, { text: "T√≠ch h·ª£p Rich Text Editor (Tiptap) v√†o form", status: 'not-started' }] },
                        { title: "Trang ƒê·ªçc truy·ªán", subtasks: [{ text: "Component: Hi·ªÉn th·ªã n·ªôi dung ch∆∞∆°ng", status: 'not-started' }, { text: "Component: ƒêi·ªÅu h∆∞·ªõng ch∆∞∆°ng tr∆∞·ªõc/sau", status: 'not-started' }, { text: "Component: Menu t√πy ch·ªânh giao di·ªán ƒë·ªçc (c·ª° ch·ªØ, n·ªÅn)", status: 'not-started' }] }
                    ]
                },
                khoi: {
                    name: "Kh√¥i", color: "emerald", tasks: [
                        { title: "Trang ch·ªß (/)", subtasks: [{ text: "Component: Banner/Slider truy·ªán n·ªïi b·∫≠t", status: 'not-started' }, { text: "Component: Danh s√°ch truy·ªán m·ªõi c·∫≠p nh·∫≠t", status: 'not-started' }, { text: "Component: Danh s√°ch truy·ªán xem nhi·ªÅu", status: 'not-started' }, { text: "Component: B·∫£ng x·∫øp h·∫°ng thu nh·ªè", status: 'not-started' }] },
                        
                        { title: "Trang T√¨m ki·∫øm & L·ªçc", subtasks: [{ text: "Component: Thanh t√¨m ki·∫øm", status: 'not-started' }, { text: "Component: C√°c b·ªô l·ªçc (th·ªÉ lo·∫°i, tr·∫°ng th√°i)", status: 'not-started' }, { text: "Component: C√°c t√πy ch·ªçn s·∫Øp x·∫øp", status: 'not-started' }, { text: "Component: L∆∞·ªõi hi·ªÉn th·ªã k·∫øt qu·∫£ truy·ªán", status: 'not-started' }] },
                        { title: "Trang B·∫£ng x·∫øp h·∫°ng", subtasks: [{ text: "Component: Tabs chuy·ªÉn ƒë·ªïi (Top View, Top Rating...)", status: 'not-started' }, { text: "Component: Danh s√°ch truy·ªán x·∫øp h·∫°ng", status: 'not-started' }] },
                        {
                            title: "Trang 404 Not Found",
                            subtasks: [
                                { text: "Component: Thi·∫øt k·∫ø v√† hi·ªÉn th·ªã trang 404", status: 'not-started' },
                                { text: "Logic: C·∫•u h√¨nh router ƒë·ªÉ b·∫Øt c√°c route kh√¥ng t·ªìn t·∫°i", status: 'not-started' }
                            ]
                        }
                    ]
                },
                hoang: {
                    name: "Ho√†ng", color: "amber", tasks: [
                        { title: "ƒêƒÉng nh·∫≠p / ƒêƒÉng k√Ω", subtasks: [{ text: "Component: Form ƒëƒÉng nh·∫≠p (email/pass)", status: 'not-started' }, { text: "Component: Form ƒëƒÉng k√Ω", status: 'not-started' }, { text: "Component: N√∫t ƒëƒÉng nh·∫≠p b·∫±ng Google", status: 'not-started' }] },
                        { title: "Trang C√° nh√¢n", subtasks: [{ text: "Component: Th√¥ng tin ng∆∞·ªùi d√πng (avatar, username)", status: 'not-started' }, { text: "Component: C√°c ch·ªâ s·ªë th·ªëng k√™", status: 'not-started' }, { text: "Component: Tabs (Truy·ªán ƒë√£ ƒëƒÉng, T·ªß truy·ªán, L·ªãch s·ª≠ ƒë·ªçc...)", status: 'not-started' }, { text: "Component: Danh s√°ch ng∆∞·ªùi theo d√µi/ƒëang theo d√µi", status: 'not-started' }] },
                        { title: "H·ªá th·ªëng ƒê√°nh gi√°", subtasks: [{ text: "Component: Hi·ªÉn th·ªã ƒëi·ªÉm sao trung b√¨nh", status: 'not-started' }, { text: "Component: Form g·ª≠i ƒë√°nh gi√° (ch·∫•m sao & vi·∫øt review)", status: 'not-started' }] },
                        { title: "H·ªá th·ªëng B√¨nh lu·∫≠n", subtasks: [{ text: "Component: Danh s√°ch b√¨nh lu·∫≠n (h·ªó tr·ª£ tr·∫£ l·ªùi l·ªìng nhau)", status: 'not-started' }, { text: "Component: Form g·ª≠i b√¨nh lu·∫≠n/tr·∫£ l·ªùi", status: 'not-started' }] },
                        { title: "C√°c Component t∆∞∆°ng t√°c", subtasks: [{ text: "Component: N√∫t Bookmark (Th√™m/x√≥a kh·ªèi t·ªß truy·ªán)", status: 'not-started' }, { text: "Component: N√∫t Theo d√µi/B·ªè theo d√µi", status: 'not-started' }] },
                        {
                            title: "Trang Qu√™n m·∫≠t kh·∫©u",
                            subtasks: [
                                { text: "Component: Form nh·∫≠p email ƒë·ªÉ g·ª≠i link reset", status: 'not-started' },
                                { text: "Component: Form nh·∫≠p m·∫≠t kh·∫©u m·ªõi", status: 'not-started' },
                                { text: "Logic: G·ªçi API g·ª≠i link v√† API reset m·∫≠t kh·∫©u", status: 'not-started' }
                            ]
                        }
                    ]
                },
                tung: {
                    name: "T√πng", color: "rose", tasks: [
                        { title: "Component chung", subtasks: [{ text: "Component: Header (Thanh ƒëi·ªÅu h∆∞·ªõng ch√≠nh)", status: 'not-started' }, { text: "Component: Footer (Ch√¢n trang)", status: 'not-started' }, { text: "Component: StoryCard (Hi·ªÉn th·ªã truy·ªán trong danh s√°ch)", status: 'not-started' }, { text: "Component: Pagination (Ph√¢n trang)", status: 'not-started' }] },
                        { title: "Author Dashboard", subtasks: [{ text: "Component: Th·ªëng k√™ t·ªïng quan cho t√°c gi·∫£", status: 'not-started' }, { text: "Component: B·∫£ng danh s√°ch c√°c truy·ªán ƒë√£ ƒëƒÉng", status: 'not-started' }] },
                        { title: "Admin Dashboard", subtasks: [{ text: "Component: Layout ch√≠nh cho trang qu·∫£n tr·ªã", status: 'not-started' }, { text: "Component: C√°c widget th·ªëng k√™ website", status: 'not-started' }] },
                        { title: "Admin: Duy·ªát truy·ªán", subtasks: [{ text: "Component: B·∫£ng danh s√°ch truy·ªán ch·ªù duy·ªát", status: 'not-started' }, { text: "Ch·ª©c nƒÉng: Xem tr∆∞·ªõc n·ªôi dung truy·ªán", status: 'not-started' }, { text: "Ch·ª©c nƒÉng: N√∫t Duy·ªát/T·ª´ ch·ªëi truy·ªán", status: 'not-started' }] },
                        {
                            title: "Admin: Qu·∫£n l√Ω Ng∆∞·ªùi d√πng",
                            subtasks: [
                                { text: "Component: B·∫£ng danh s√°ch ng∆∞·ªùi d√πng", status: 'not-started' },
                                { text: "Ch·ª©c nƒÉng: Thay ƒë·ªïi vai tr√≤ (role) c·ªßa ng∆∞·ªùi d√πng", status: 'not-started' },
                                { text: "Ch·ª©c nƒÉng: Kh√≥a/M·ªü kh√≥a t√†i kho·∫£n ng∆∞·ªùi d√πng", status: 'not-started' }
                            ]
                        },
                        {
                            title: "Admin: Qu·∫£n l√Ω Th·ªÉ lo·∫°i",
                            subtasks: [
                                { text: "Component: B·∫£ng danh s√°ch th·ªÉ lo·∫°i", status: 'not-started' },
                                { text: "Component: Form th√™m/s·ª≠a th·ªÉ lo·∫°i", status: 'not-started' },
                                { text: "Logic: G·ªçi API CRUD cho th·ªÉ lo·∫°i", status: 'not-started' }
                            ]
                        }
                    ]
                }
            };

            const phasesContainer = document.getElementById('phases-container');
            const frontendContainer = document.getElementById('frontend-progress-container');
            let charts = {};

            // ---- T√çNH TO√ÅN TI·∫æN ƒê·ªò ---- //
            function calculateBackendProgress() {
                let totalTasks = 0;
                let completedTasks = 0;
                backendData.phases.forEach(phase => {
                    totalTasks += phase.tasks.length;
                    completedTasks += phase.tasks.filter(t => t.done).length;
                });
                const percentage = totalTasks > 0 ? (completedTasks / totalTasks) * 100 : 0;
                return { total: totalTasks, completed: completedTasks, percentage: percentage };
            }

            function calculateFrontendProgress() {
                const progress = {};
                for (const owner in frontendData) {
                    let totalSubtasks = 0;
                    let completedSubtasks = 0;
                    frontendData[owner].tasks.forEach(task => {
                        totalSubtasks += task.subtasks.length;
                        completedSubtasks += task.subtasks.filter(sub => sub.status === 'completed').length;
                    });
                    const percentage = totalSubtasks > 0 ? (completedSubtasks / totalSubtasks) * 100 : 0;
                    progress[owner] = { total: totalSubtasks, completed: completedSubtasks, percentage: percentage };
                }
                return progress;
            }

            function calculateMainTaskStatus(subtasks) {
                if (subtasks.some(s => s.status === 'blocked')) return 'blocked';
                if (subtasks.some(s => s.status === 'in-progress')) return 'in-progress';
                if (subtasks.every(s => s.status === 'completed')) return 'completed';
                return 'not-started';
            }

            // ---- V·∫º V√Ä C·∫¨P NH·∫¨T GIAO DI·ªÜN ---- //
            function renderBackendPhases() {
                phasesContainer.innerHTML = '';
                backendData.phases.forEach((phase, index) => {
                    const phaseElement = document.createElement('div');
                    phaseElement.className = 'bg-white rounded-xl shadow-md overflow-hidden';
                    const completedTasks = phase.tasks.filter(t => t.done).length;
                    const totalTasks = phase.tasks.length;

                    phaseElement.innerHTML = `
                        <div class="phase-header p-4 border-b border-slate-200 flex justify-between items-center">
                            <div>
                                <h3 class="text-lg font-bold text-slate-900">${phase.title}</h3>
                                <p class="text-sm text-slate-500">${phase.goal}</p>
                            </div>
                            <div class="flex items-center space-x-4">
                               <span class="text-sm font-semibold text-sky-600">${completedTasks}/${totalTasks}</span>
                               <svg class="w-6 h-6 text-slate-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" /></svg>
                            </div>
                        </div>
                        <div class="task-list hidden p-4 space-y-3">
                            ${phase.tasks.map((task, taskIndex) => `
                                <label class="flex items-center space-x-3 cursor-pointer">
                                    <input type="checkbox" data-phase-index="${index}" data-task-index="${taskIndex}" class="task-checkbox h-5 w-5 rounded border-gray-300 text-sky-600 focus:ring-sky-500" ${task.done ? 'checked' : ''}>
                                    <span class="task-text text-slate-700">${task.text}</span>
                                </label>
                            `).join('')}
                        </div>`;
                    phasesContainer.appendChild(phaseElement);
                });
                addEventListenersToBackendTasks();
            }

            function renderFrontendTasks() {
                frontendContainer.innerHTML = '';
                for (const ownerKey in frontendData) {
                    const ownerData = frontendData[ownerKey];
                    const ownerDiv = document.createElement('div');
                    ownerDiv.className = 'bg-white p-6 rounded-xl shadow-md';
                    ownerDiv.dataset.owner = ownerKey;

                    const colorClasses = { sky: 'text-sky-600', rose: 'text-rose-600', amber: 'text-amber-600', emerald: 'text-emerald-600' };
                    const statusText = { 'not-started': '‚ö™ Ch∆∞a b·∫Øt ƒë·∫ßu', 'in-progress': 'üü° ƒêang l√†m', 'completed': 'üü¢ Ho√†n th√†nh', 'blocked': 'üî¥ G·∫∑p kh√≥ khƒÉn' };

                    let tasksHtml = '';
                    ownerData.tasks.forEach((task, taskIndex) => {
                        const mainTaskStatus = calculateMainTaskStatus(task.subtasks);
                        tasksHtml += `
                            <div class="py-2">
                                <details>
                                    <summary class="frontend-task-header flex justify-between items-center list-none rounded -m-2 p-2">
                                        <span>${task.title}</span>
                                        <span class="status-badge status-${mainTaskStatus}" id="main-task-${ownerKey}-${taskIndex}">${statusText[mainTaskStatus]}</span>
                                    </summary>
                                    <ul class="subtask-list mt-3 space-y-3 text-sm text-slate-600">
                                        ${task.subtasks.map((sub, subIndex) => `
                                            <li class="flex justify-between items-center">
                                                <span>${sub.text}</span>
                                                <select class="status-select" data-owner="${ownerKey}" data-task-index="${taskIndex}" data-sub-index="${subIndex}">
                                                    <option value="not-started" ${sub.status === 'not-started' ? 'selected' : ''}>Ch∆∞a b·∫Øt ƒë·∫ßu</option>
                                                    <option value="in-progress" ${sub.status === 'in-progress' ? 'selected' : ''}>ƒêang l√†m</option>
                                                    <option value="completed" ${sub.status === 'completed' ? 'selected' : ''}>Ho√†n th√†nh</option>
                                                    <option value="blocked" ${sub.status === 'blocked' ? 'selected' : ''}>G·∫∑p kh√≥ khƒÉn</option>
                                                </select>
                                            </li>
                                        `).join('')}
                                    </ul>
                                </details>
                            </div>
                        `;
                    });

                    ownerDiv.innerHTML = `
                        <h3 class="text-xl font-bold text-center mb-4">Frontend - ${ownerData.name}</h3>
                        <div class="flex items-center gap-4">
                            <div class="progress-chart-container flex-shrink-0">
                                <canvas id="${ownerKey}ProgressChart"></canvas>
                            </div>
                            <div class="flex-grow text-center">
                                <p class="text-3xl font-bold ${colorClasses[ownerData.color]}" id="${ownerKey}-percentage">0%</p>
                                <p class="text-slate-500 text-sm" id="${ownerKey}-tasks-summary">0/0 subtasks</p>
                            </div>
                        </div>
                        <details class="mt-4">
                            <summary class="cursor-pointer text-sm font-medium text-slate-600 hover:text-slate-900">Xem chi ti·∫øt c√¥ng vi·ªác</summary>
                            <div class="mt-3 space-y-1 divide-y divide-slate-100">
                                ${tasksHtml}
                            </div>
                        </details>
                    `;
                    frontendContainer.appendChild(ownerDiv);
                }
                addEventListenersToFrontendTasks();
            }
            
            function updateDashboard() {
                // Update Backend
                const backendProgress = calculateBackendProgress();
                document.getElementById('backend-percentage').textContent = `${Math.round(backendProgress.percentage)}%`;
                document.getElementById('backend-tasks-summary').textContent = `${backendProgress.completed}/${backendProgress.total} c√¥ng vi·ªác ho√†n th√†nh`;
                if (charts.backend) {
                    charts.backend.data.datasets[0].data = [backendProgress.completed, backendProgress.total - backendProgress.completed];
                    charts.backend.update();
                }

                // Update Frontend
                const frontendProgress = calculateFrontendProgress();
                for (const owner in frontendProgress) {
                    const progress = frontendProgress[owner];
                    document.getElementById(`${owner}-percentage`).textContent = `${Math.round(progress.percentage)}%`;
                    document.getElementById(`${owner}-tasks-summary`).textContent = `${progress.completed}/${progress.total} subtasks`;
                    if (charts[owner]) {
                        charts[owner].data.datasets[0].data = [progress.completed, progress.total - progress.completed];
                        charts[owner].update();
                    }
                }
            }

            function createChart(canvasId, colors, initialData) {
                const ctx = document.getElementById(canvasId).getContext('2d');
                return new Chart(ctx, {
                    type: 'doughnut',
                    data: { labels: ['Ho√†n th√†nh', 'Ch∆∞a l√†m'], datasets: [{ data: initialData, backgroundColor: colors, borderColor: '#ffffff', borderWidth: 4, hoverOffset: 8 }] },
                    options: { responsive: true, maintainAspectRatio: false, cutout: '70%', plugins: { legend: { display: false }, tooltip: { enabled: true } } }
                });
            }

            function createAllCharts() {
                const backendProgress = calculateBackendProgress();
                charts.backend = createChart('backendProgressChart', ['#0284c7', '#e0f2fe'], [backendProgress.completed, backendProgress.total - backendProgress.completed]);

                const frontendProgress = calculateFrontendProgress();
                charts.minh = createChart('minhProgressChart', ['#0ea5e9', '#e0f2fe'], [frontendProgress.minh.completed, frontendProgress.minh.total - frontendProgress.minh.completed]);
                charts.khoi = createChart('khoiProgressChart', ['#e11d48', '#ffe4e6'], [frontendProgress.khoi.completed, frontendProgress.khoi.total - frontendProgress.khoi.completed]);
                charts.hoang = createChart('hoangProgressChart', ['#d97706', '#fef3c7'], [frontendProgress.hoang.completed, frontendProgress.hoang.total - frontendProgress.hoang.completed]);
                charts.tung = createChart('tungProgressChart', ['#10b981', '#d1fae5'], [frontendProgress.tung.completed, frontendProgress.tung.total - frontendProgress.tung.completed]);
            }

            // ---- G·∫ÆN S·ª∞ KI·ªÜN ---- //
            function addEventListenersToBackendTasks() {
                document.querySelectorAll('.phase-header').forEach(header => {
                    header.addEventListener('click', () => {
                        header.nextElementSibling.classList.toggle('hidden');
                        header.querySelector('svg').classList.toggle('rotate-180');
                    });
                });

                document.querySelectorAll('.task-checkbox').forEach(checkbox => {
                    checkbox.addEventListener('change', (e) => {
                        const { phaseIndex, taskIndex } = e.target.dataset;
                        backendData.phases[phaseIndex].tasks[taskIndex].done = e.target.checked;
                        renderBackendPhases();
                        updateDashboard();
                    });
                });
            }

            function addEventListenersToFrontendTasks() {
                document.querySelectorAll('.status-select').forEach(select => {
                    select.addEventListener('change', (e) => {
                        const { owner, taskIndex, subIndex } = e.target.dataset;
                        frontendData[owner].tasks[taskIndex].subtasks[subIndex].status = e.target.value;
                        
                        const mainTask = frontendData[owner].tasks[taskIndex];
                        const mainTaskStatus = calculateMainTaskStatus(mainTask.subtasks);
                        const mainTaskBadge = document.getElementById(`main-task-${owner}-${taskIndex}`);
                        const statusText = { 'not-started': '‚ö™ Ch∆∞a b·∫Øt ƒë·∫ßu', 'in-progress': 'üü° ƒêang l√†m', 'completed': 'üü¢ Ho√†n th√†nh', 'blocked': 'üî¥ G·∫∑p kh√≥ khƒÉn' };
                        mainTaskBadge.textContent = statusText[mainTaskStatus];
                        mainTaskBadge.className = `status-badge status-${mainTaskStatus}`;
                        
                        updateDashboard();
                    });
                });
            }
            
            // ---- KH·ªûI CH·∫†Y ---- //
            renderBackendPhases();
            renderFrontendTasks();
            createAllCharts();
            updateDashboard();
        });
    </script>
</body>

</ht
